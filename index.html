<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Explore the Afrofuturistic universe of Steve Universe, featuring novels, news, and interactive AI. Discover Pishon: The Uprising, The Flare, and more.">
    <meta name="keywords" content="Steve Universe, Afrofuturism, African sci-fi, Pishon, The Flare, books, novels, Abuja author">
    <meta name="author" content="Justice Muhammed Okan">
    <title>Steve Universe - Afrofuturistic Tales</title>
    <link href="/css/tailwind.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            color: #e5e7eb;
            background: url('/images/cosmic-bg.jpg') no-repeat center center fixed;
            background-size: cover;
        }
        .section-bg {
            background: linear-gradient(135deg, rgba(17, 24, 39, 0.8), rgba(44, 82, 130, 0.8));
            backdrop-filter: blur(8px);
            border-radius: 1rem;
            padding: 24px;
        }
        .hero-bg {
            background: url('/images/hero-bg.jpg') no-repeat center center;
            background-size: cover;
            min-height: 80vh;
            display: flex;
            align-items: center;
        }
        .book-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .book-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.5);
        }
        .nav-link {
            transition: color 0.2s ease;
        }
        .nav-link:hover {
            color: #60a5fa;
        }
        .chat-handle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #3b82f6, #7c3aed);
            color: white;
            padding: 12px 24px;
            border-radius: 9999px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.3s, box-shadow 0.3s;
            z-index: 1000;
            animation: float 2s ease-in-out infinite;
        }
        .chat-handle:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.5);
        }
        .chat-handle img {
            width: 24px;
            height: 24px;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
        }
        .chat-container {
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 360px;
            background: #1f2937;
            border-radius: 12px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            z-index: 999;
        }
        .chat-container.active {
            display: block;
        }
        .chat-header {
            background: linear-gradient(135deg, #3b82f6, #7c3aed);
            color: white;
            padding: 16px;
            font-weight: 600;
        }
        .chat-body {
            max-height: 320px;
            overflow-y: auto;
            padding: 16px;
            background: #111827;
        }
        .chat-input {
            display: flex;
            padding: 12px;
            background: #1f2937;
            border-top: 1px solid #374151;
        }
        .chat-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #4b5563;
            border-radius: 6px;
            margin-right: 10px;
            background: #1f2937;
            color: #e5e7eb;
        }
        .chat-input button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .chat-input button:hover {
            background: #2563eb;
        }
        .chat-message {
            margin: 10px 0;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.9rem;
        }
        .chat-message.user {
            background: #3b82f6;
            color: white;
            margin-left: 20%;
            text-align: right;
        }
        .chat-message.bot {
            background: #374151;
            margin-right: 20%;
        }
        .quote {
            font-style: italic;
            color: #93c5fd;
            margin-top: 8px;
        }
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
            100% { transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="bg-gray-900 bg-opacity-90 fixed w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <a href="#" class="text-2xl font-bold text-white">Steve Universe</a>
                <div class="hidden md:flex space-x-8">
                    <a href="#home" class="nav-link text-gray-300">Home</a>
                    <a href="#books" class="nav-link text-gray-300">Books</a>
                    <a href="#news" class="nav-link text-gray-300">News</a>
                    <a href="#stories" class="nav-link text-gray-300">Stories</a>
                    <a href="#contact" class="nav-link text-gray-300">Contact</a>
                    <a href="#about" class="nav-link text-gray-300">About</a>
                </div>
                <button id="mobile-menu-button" class="md:hidden text-gray-300">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-gray-800">
            <a href="#home" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">Home</a>
            <a href="#books" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">Books</a>
            <a href="#news" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">News</a>
            <a href="#stories" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">Stories</a>
            <a href="#contact" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">Contact</a>
            <a href="#about" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">About</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-bg">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-white fade-in">Welcome to Steve Universe</h1>
            <p class="mt-4 text-lg sm:text-xl text-gray-200 fade-in">Embark on a journey through Afrofuturistic tales of heroism, love, and destiny.</p>
            <a href="#books" class="mt-6 inline-block bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition">Explore Books</a>
        </div>
    </section>

    <!-- Books Section -->
    <section id="books" class="py-16 bg-gray-900 bg-opacity-80">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12 fade-in">Books</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="book-card section-bg p-6">
                    <img src="/images/pishon-cover.jpg" alt="Pishon: The Uprising" class="w-full h-40 object-cover rounded-lg mb-4">
                    <h3 class="text-xl font-semibold">Pishon: The Uprising</h3>
                    <p class="mt-2 text-gray-300">Dayo, a young man with a stained history, rises as the Super Agent to protect Pishon from conspiracies and supernatural threats.</p>
                    <div class="mt-4 flex justify-between">
                        <a href="#" class="text-blue-400 hover:underline">Read Online</a>
                        <a href="#" class="text-blue-400 hover:underline">Buy Now</a>
                    </div>
                </div>
                <div class="book-card section-bg p-6">
                    <img src="/images/flare-cover.jpg" alt="The Flare" class="w-full h-40 object-cover rounded-lg mb-4">
                    <h3 class="text-xl font-semibold">The Flare</h3>
                    <p class="mt-2 text-gray-300">Alex Rosicky, resurrected by the Neon Stone, becomes The Flare, battling rogue superhumans and an ancient evil in Wellrose.</p>
                    <div class="mt-4 flex justify-between">
                        <a href="#" class="text-blue-400 hover:underline">Read Online</a>
                        <a href="#" class="text-blue-400 hover:underline">Buy Now</a>
                    </div>
                </div>
                <div class="book-card section-bg p-6">
                    <img src="/images/orchids.jpg" alt="Orchids" class="w-full h-40 object-cover rounded-lg mb-4">
                    <h3 class="text-xl font-semibold">Orchids</h3>
                    <p class="mt-2 text-gray-300">A timeless tale of love that spans ages, weaving romance and destiny in an Afrofuturistic world.</p>
                    <div class="mt-4 flex justify-between">
                        <a href="#" class="text-blue-400 hover:underline">Read Online</a>
                        <a href="#" class="text-blue-400 hover:underline">Buy Now</a>
                    </div>
                </div>
                <div class="book-card section-bg p-6">
                    <img src="/images/teenage-r.jpg" alt="Teen-Age R" class="w-full h-40 object-cover rounded-lg mb-4">
                    <h3 class="text-xl font-semibold">Teen-Age R</h3>
                    <p class="mt-2 text-gray-300">Ordinary high school teens navigate love and identity in a world of superheroes and chaos.</p>
                    <div class="mt-4 flex justify-between">
                        <a href="#" class="text-blue-400 hover:underline">Read Online</a>
                        <a href="#" class="text-blue-400 hover:underline">Buy Now</a>
                    </div>
                </div>
                <div class="book-card section-bg p-6">
                    <img src="/images/within-the-dark.jpg" alt="Within The Dark" class="w-full h-40 object-cover rounded-lg mb-4">
                    <h3 class="text-xl font-semibold">Within The Dark</h3>
                    <p class="mt-2 text-gray-300">In a world ruled by a tyrannical Church, whispers of a Chosen One spark hope amidst bloodshed.</p>
                    <div class="mt-4 flex justify-between">
                        <a href="#" class="text-blue-400 hover:underline">Read Online</a>
                        <a href="#" class="text-blue-400 hover:underline">Buy Now</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- News Section -->
    <section id="news" class="py-16 bg-gray-900 bg-opacity-80">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12 fade-in">Latest News</h2>
            <div id="news-grid" class="grid grid-cols-1 sm:grid-cols-2 gap-8">
                <!-- News items populated by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Stories Section -->
    <section id="stories" class="py-16 bg-gray-900 bg-opacity-80">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12 fade-in">Daily Cosmic Stories</h2>
            <div id="stories-grid" class="grid grid-cols-1 sm:grid-cols-2 gap-8">
                <!-- Stories and quotes populated by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-16 bg-gray-900 bg-opacity-80">
        <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12 fade-in">Get in Touch</h2>
            <form action="https://formspree.io/f/xgvykzbg" method="POST" id="contact-form" class="space-y-6 section-bg p-8 rounded-lg">
                <div>
                    <label for="name" class="block text-sm font-medium">Name</label>
                    <input type="text" id="name" name="name" class="mt-1 w-full p-3 rounded-lg border border-gray-600 bg-gray-800 text-gray-200" placeholder="Your Name" required>
                </div>
                <div>
                    <label for="email" class="block text-sm font-medium">Email</label>
                    <input type="email" id="email" name="_replyto" class="mt-1 w-full p-3 rounded-lg border border-gray-600 bg-gray-800 text-gray-200" placeholder="Your Email" required>
                </div>
                <div>
                    <label for="message" class="block text-sm font-medium">Message</label>
                    <textarea id="message" name="message" class="mt-1 w-full p-3 rounded-lg border border-gray-600 bg-gray-800 text-gray-200" rows="5" placeholder="Your Message" required></textarea>
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">Send Message</button>
                <p id="form-message" class="text-center text-sm mt-4 hidden"></p>
            </form>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-16 bg-gray-900 bg-opacity-80">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12 fade-in">About Steve Universe</h2>
            <div class="section-bg p-8 rounded-lg flex flex-col md:flex-row items-center">
                <img src="/images/shero.jpg" alt="Justice Muhammed Okan" class="w-40 h-40 rounded-full mb-6 md:mb-0 md:mr-8">
                <div>
                    <p class="text-gray-300">I’m Justice Muhammed Okan, writing as Steve Universe, from Abuja, Nigeria. Since age 16, I’ve crafted Afrofuturistic tales to fill the gap in African sci-fi. With a degree in Educational Administration from the University of Abuja, I teach while dreaming up vibrant futures.</p>
                    <p class="mt-4 text-gray-300">My mission is to ignite a universe of interconnected African stories, starting with Pishon: The Uprising and beyond.</p>
                    <a href="#contact" class="mt-4 inline-block text-blue-400 hover:underline">Connect with Me</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-300 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <p>© 2025 Steve Universe. All rights reserved.</p>
                <div class="flex space-x-6 mt-4 md:mt-0">
                    <a href="https://x.com"><img src="/images/x-icon.png" alt="X" class="w-8 h-8"></a>
                    <a href="https://facebook.com"><img src="/images/facebook-icon.png" alt="Facebook" class="w-8 h-8"></a>
                    <a href="mailto:your.email@gmail.com"><img src="/images/gmail-icon.png" alt="Gmail" class="w-8 h-8"></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Chatbot -->
    <div id="chatbot-handle" class="chat-handle">
        <img src="/images/chatbot-icon.png" alt="Chatbot Icon"> Cosmic AI
    </div>
    <div id="chat-container" class="chat-container">
        <div class="chat-header">Steve's Cosmic AI</div>
        <div id="chat-body" class="chat-body"></div>
        <div class="chat-input">
            <input type="text" id="chat-input" placeholder="Type your message...">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

    <script>
        // Mobile Menu Toggle
        document.getElementById('mobile-menu-button').addEventListener('click', () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });

        // Smooth Scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Contact Form Submission
        document.getElementById('contact-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const form = e.target;
            const formMessage = document.getElementById('form-message');
            formMessage.classList.remove('hidden', 'text-red-400', 'text-green-400');
            try {
                const response = await fetch(form.action, {
                    method: 'POST',
                    body: new FormData(form),
                    headers: { 'Accept': 'application/json' }
                });
                if (response.ok) {
                    formMessage.classList.add('text-green-400');
                    formMessage.textContent = 'Message sent successfully!';
                    form.reset();
                } else {
                    throw new Error('Submission failed');
                }
            } catch (error) {
                formMessage.classList.add('text-red-400');
                formMessage.textContent = 'Error sending message. Please try again.';
            }
        });

        // News API Integration
        async function fetchNews() {
            const newsGrid = document.getElementById('news-grid');
            newsGrid.innerHTML = '<p class="text-center text-gray-300 col-span-2">Loading news...</p>';
            try {
                const response = await fetch('https://newsapi.org/v2/everything?q=afrofuturism+OR+"african sci-fi"&language=en&sortBy=publishedAt&apiKey=152b457b574b4916b1bdf59cca1c0201');
                const data = await response.json();
                newsGrid.innerHTML = '';
                if (data.articles && data.articles.length > 0) {
                    data.articles.slice(0, 2).forEach(article => {
                        const newsItem = document.createElement('div');
                        newsItem.className = 'section-bg p-6 rounded-lg';
                        newsItem.innerHTML = `
                            <h3 class="text-xl font-semibold">${article.title}</h3>
                            <p class="mt-2 text-gray-300">${article.description || 'No description available.'}</p>
                            <a href="${article.url}" target="_blank" class="text-blue-400 hover:underline mt-4 inline-block">Read More</a>
                        `;
                        newsGrid.appendChild(newsItem);
                    });
                } else {
                    newsGrid.innerHTML = '<p class="text-center text-gray-300 col-span-2">No recent news found. Check back later!</p>';
                }
            } catch (error) {
                newsGrid.innerHTML = '<p class="text-center text-red-400 col-span-2">Error loading news. Please try again later.</p>';
            }
        }

        // Stories Section: 25 Short Stories and Quotes
        const shortStories = [
            {
                title: 'The Neon Oracle',
                description: 'In a cybernetic Accra, Kweku follows a glowing AI to uncover a hidden prophecy.',
                genre: 'Sci-Fi',
                content: 'Kweku stumbled through Accra’s neon haze, guided by a drone pulsing with violet light. It whispered of a prophecy buried in the city’s core. At the Nexus Tower, he found a chip etched with his name. “You are the bridge,” the drone hummed. Kweku plugged in, and visions of a unified Africa flooded his mind.'
            },
            {
                title: 'The Witch’s Oath',
                description: 'Ama, a young healer, binds her soul to save her village from a curse.',
                genre: 'Fantasy',
                content: 'Ama knelt by the baobab, its bark scarred by the curse. The witch demanded her oath: a soul for the village’s salvation. She sliced her palm, blood dripping onto the roots. Light erupted, and the curse shattered. Ama stood, her eyes glowing, now tethered to the tree’s ancient magic.'
            },
            {
                title: 'Starlit Vows',
                description: 'Two lovers defy time on a crumbling lunar outpost.',
                genre: 'Romance',
                content: 'On the moon’s edge, Zara held Kofi’s hand, their suits hissing in the void. The outpost was failing, but their love burned bright. “We’ll find another sky,” Kofi promised. They sealed their bond with a kiss as Earth rose, vowing to chase eternity together.'
            },
            {
                title: 'The Silent Bell',
                description: 'A boy hears a ghostly toll in a fog-draped town.',
                genre: 'Horror',
                content: 'Tunde crept through the mist, the village bell ringing though its rope was cut. Each toll drew him to the church, where the air grew heavy. In the shadows, a figure whispered his name. He ran, but the bell followed, its chime now inside his skull.'
            },
            {
                title: 'The Last Signal',
                description: 'A lone astronaut receives a message from a dead planet.',
                genre: 'Sci-Fi',
                content: 'Ada floated in her pod, orbiting a silent Mars. A signal crackled: “We’re still here.” Impossible—Mars was dead. She traced the source to a buried beacon. Digging, she found a crystal pulsing with voices. “Join us,” it sang. Ada hesitated, her hand on the switch.'
            },
            {
                title: 'The Iron Crown',
                description: 'A thief steals a cursed relic from a forgotten king.',
                genre: 'Fantasy',
                content: 'Nia slipped into the tomb, the iron crown glinting in torchlight. She grabbed it, ignoring the warnings. Whispers filled her mind, promising power. By dawn, her eyes glowed red, and the village knelt. Nia smiled, the crown heavy, her heart no longer her own.'
            },
            {
                title: 'Echoes of Lagos',
                description: 'A detective hunts a time-traveling thief in 2070 Lagos.',
                genre: 'Mystery',
                content: 'Detective Bola chased the thief through Lagos’ floating markets, where holograms flickered. The thief’s device warped time, leaving ripples in the air. Bola cornered him by the lagoon, but the thief vanished, leaving a note: “Catch me yesterday.” Bola gripped her chrono-scanner, ready to rewrite history.'
            },
            {
                title: 'The Sky Weaver',
                description: 'An orphan discovers her power to shape clouds into machines.',
                genre: 'Adventure',
                content: 'Efia stood on the savanna, hands raised, clouds twisting into gears above. Orphaned, she’d hidden her gift until raiders attacked. Now, she wove a storm of steel wings, driving them back. The village cheered, but Efia eyed the horizon, sensing her true calling beyond.'
            },
            {
                title: 'Red Dust Duel',
                description: 'A gunslinger faces a mechanical foe in a desert wasteland.',
                genre: 'Sci-Fi',
                content: 'Jide faced the mech in the red dunes, his plasma revolver humming. The machine’s gears whirred, its eye locked on him. “Last chance,” Jide warned. It charged. He fired, sparks flying. The mech fell, but Jide heard more approaching, their hums echoing in the dust.'
            },
            {
                title: 'The Forgotten Mask',
                description: 'A dancer dons a mask that reveals hidden truths.',
                genre: 'Fantasy',
                content: 'At the festival, Aisha found the mask, its carvings glowing faintly. She wore it, and the crowd’s secrets spilled into her mind—lies, loves, betrayals. She danced, exposing truths with every step. By midnight, the mask burned her skin, whispering, “Now, you are mine.”'
            },
            {
                title: 'The Quantum Griot',
                description: 'A storyteller manipulates reality with ancient code.',
                genre: 'Sci-Fi',
                content: 'Kwame, the last griot, wove tales that bent time. His words, laced with quantum code, reshaped Lagos’ skyline. When invaders came, he spoke of peace, and their weapons dissolved. Kwame smiled, his voice a weapon, his stories the shield of a nation.'
            },
            {
                title: 'The River’s Wrath',
                description: 'A fisherman battles a river spirit to save his son.',
                genre: 'Fantasy',
                content: 'Olu cast his net, but the river roared, a spirit rising. “Your son for my freedom,” it hissed. Olu fought, his spear glowing with ancestral fire. The spirit yielded, and his son gasped awake. The river calmed, but Olu knew it watched, waiting.'
            },
            {
                title: 'The Starborn Child',
                description: 'A girl born under a comet holds the key to peace.',
                genre: 'Adventure',
                content: 'Born as a comet blazed, Zuri glowed faintly. Elders called her Starborn, destined to unite tribes. Raiders kidnapped her, but Zuri’s light burned, guiding her home. She stood tall, her radiance a beacon, her voice calling for peace across the plains.'
            },
            {
                title: 'The Ghost Circuit',
                description: 'A hacker uncovers a digital afterlife in Nairobi’s slums.',
                genre: 'Sci-Fi',
                content: 'Wanjiku jacked into Nairobi’s grid, finding a hidden network. Voices whispered—ghosts in the code. They begged for freedom. She rewrote their prison, releasing them into the cloud. The city flickered, and Wanjiku unplugged, haunted by their thanks.'
            },
            {
                title: 'The Blood Forge',
                description: 'A blacksmith crafts a weapon to end a war.',
                genre: 'Fantasy',
                content: 'Chidi hammered iron, blood fueling his forge’s fire. The blade, born of sacrifice, could end the war. He gifted it to the chief, who struck true. Peace came, but Chidi’s hands shook, the forge’s hunger now turning to him.'
            },
            {
                title: 'The Void Choir',
                description: 'A pilot hears a cosmic song that drives her mad.',
                genre: 'Horror',
                content: 'Fatima’s ship drifted near a black hole, a choir humming in her mind. It sang of eternity, pulling her closer. She fought, but the song drowned her thoughts. Her crew found her smiling, steering into the void, whispering, “I’m home.”'
            },
            {
                title: 'The Time Weaver',
                description: 'A seamstress stitches time to save her lover.',
                genre: 'Romance',
                content: 'Adanna’s needle wove time, each stitch saving Kofi from death. She worked, years slipping away. Kofi woke, but Adanna faded, her thread spent. He kissed her, vowing to find her in another timeline, her needle still in hand.'
            },
            {
                title: 'The Obsidian Blade',
                description: 'A warrior faces her destiny in a volcanic arena.',
                genre: 'Adventure',
                content: 'Yemi gripped her obsidian blade, lava glowing below. The arena roared, her foe a giant. She leaped, blade flashing, and struck true. The crowd knelt, naming her champion. Yemi looked to the stars, her destiny just beginning.'
            },
            {
                title: 'The Pulse Thief',
                description: 'A rogue steals energy from a sentient city.',
                genre: 'Sci-Fi',
                content: 'Tobi siphoned power from Kinshasa’s core, its AI pleading. Each pulse lit his hideout, but the city dimmed. Guards closed in, but Tobi returned the energy, saving it. Kinshasa spared him, its lights now his guide.'
            },
            {
                title: 'The Moonlit Pact',
                description: 'Twins make a deal with a lunar deity.',
                genre: 'Fantasy',
                content: 'Ife and Taiwo stood under the moon, its deity offering power. They swore loyalty, gaining strength. But the moon demanded blood. They fought its pull, saving each other. Dawn broke, the pact broken, their bond stronger than gods.'
            },
            {
                title: 'The Codebreaker’s Curse',
                description: 'A cryptographer decodes a message that dooms her.',
                genre: 'Mystery',
                content: 'Sana cracked the cipher, revealing a plot against Abuja. But the code cursed her, visions haunting her sleep. She warned the city, saving it. The visions faded, but Sana kept her pen, ready for the next riddle.'
            },
            {
                title: 'The Ember Child',
                description: 'A girl born of fire seeks her origins.',
                genre: 'Adventure',
                content: 'Aminat’s skin sparked, flames dancing in her steps. She crossed deserts, seeking her fire’s source. A volcano spoke, claiming her as kin. She embraced it, her flames lighting the night, a beacon for wanderers.'
            },
            {
                title: 'The Shadow Net',
                description: 'A teen hacks a secret network controlling her city.',
                genre: 'Sci-Fi',
                content: 'Lara breached the Shadow Net, Cape Town’s hidden controller. It fought back, locking her mind. She rewrote its core, freeing the city. Lara unplugged, her screen dark, but her name echoed in the streets.'
            },
            {
                title: 'The Bone Flute',
                description: 'A musician plays a tune that wakes the dead.',
                genre: 'Horror',
                content: 'Kofi played the bone flute, its notes raising spirits. They danced, but hungered for life. He played a final note, banishing them. The flute cracked, and Kofi buried it, fearing its song still lingered.'
            },
            {
                title: 'The Crystal Veil',
                description: 'A priestess sees the future in a sacred gem.',
                genre: 'Fantasy',
                content: 'Nneka gazed into the crystal, futures unfolding. She saw war, then peace. Her visions guided the tribe, but the gem darkened, trapping her. Nneka shattered it, blind but free, her wisdom now her light.'
            }
        ];

        const quotes = [
            '“Imagination is the key to uncharted worlds.” — Steve Universe',
            '“In every story, a spark of truth ignites.” — Unknown',
            '“The future is woven from our dreams.” — Afrofuturist Proverb',
            '“Create boldly, for the stars are watching.” — Cosmic AI',
            '“Every tale reshapes the universe.” — Justice Muhammed Okan',
            '“In chaos, stories find their voice.” — African Sci-Fi Maxim',
            '“The pen carves paths where feet fear to tread.” — Unknown',
            '“Dreams are the seeds of tomorrow’s reality.” — Steve Universe',
            '“A story is a bridge between hearts.” — Afrofuturist Saying',
            '“The cosmos hums with untold tales.” — Cosmic AI',
            '“Write the future, one word at a time.” — Steve Universe',
            '“Roots and stars weave the same tale.” — Afrofuturist Proverb',
            '“Every story is a rebellion.” — Unknown',
            '“The universe bends to a bold pen.” — Cosmic AI',
            '“Our tales light the path to tomorrow.” — Justice Muhammed Okan'
        ];

        let selectedStories = [];

        function displayStories() {
            const storiesGrid = document.getElementById('stories-grid');
            storiesGrid.innerHTML = '';
            const today = new Date().toISOString().split('T')[0];
            const seed = today.split('-').join('');

            // Deterministic random selection based on date
            const shuffle = (array, seed) => {
                let m = array.length, t, i;
                const rng = () => {
                    const x = Math.sin(seed++) * 10000;
                    return x - Math.floor(x);
                };
                while (m) {
                    m--;
                    i = Math.floor(rng() * (m + 1));
                    t = array[m];
                    array[m] = array[i];
                    array[i] = t;
                }
                return array;
            };

            selectedStories = shuffle([...shortStories], seed).slice(0, 2);
            const selectedQuotes = shuffle([...quotes], seed + '1').slice(0, 2);

            selectedStories.forEach((story, index) => {
                const storyItem = document.createElement('div');
                storyItem.className = 'section-bg p-6 rounded-lg';
                storyItem.innerHTML = `
                    <h3 class="text-xl font-semibold">${story.title} <span class="text-sm text-gray-400">(${story.genre})</span></h3>
                    <p class="mt-2 text-gray-300">${story.description}</p>
                    <p class="quote mt-2">"${selectedQuotes[index]}"</p>
                    <a href="#" class="text-blue-400 hover:underline mt-4 inline-block">Read More</a>
                `;
                storiesGrid.appendChild(storyItem);
            });
        }

        function downloadStories() {
            const today = new Date().toISOString().split('T')[0];
            const storiesGrid = document.getElementById('stories-grid');
            const content = Array.from(storiesGrid.children).map(storyEl => {
                const title = storyEl.querySelector('h3').childNodes[0].textContent.trim();
                const genre = storyEl.querySelector('span').textContent.replace(/[()]/g, '');
                const description = storyEl.querySelector('p:not(.quote)').textContent;
                const quote = storyEl.querySelector('.quote').textContent.replace(/^"|"$/g, '');
                return `Title: ${title} (${genre})\n\n${description}\n\nQuote: "${quote}"\n\n---\n`;
            }).join('\n');

            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `steve-universe-stories-${today}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            return "Downloading today's stories! Check your downloads for the text file.";
        }

        function finishStory(title) {
            const story = shortStories.find(s => s.title.toLowerCase() === title.toLowerCase());
            if (!story) {
                return `Story "${title}" not found. Try titles like "${shortStories[0].title}" or "${shortStories[1].title}".`;
            }

            const endings = {
                'The Neon Oracle': 'Visions cleared, Kweku saw Africa’s future—cities of light, united. He unplugged, the chip warm in his hand. The drone hovered, now silent. Kweku vowed to share the prophecy, leading his people to a new dawn.',
                'The Witch’s Oath': 'Ama’s bond with the baobab deepened, her life tied to its roots. She healed the village, but felt its pull. One night she merged with the tree, her spirit its guardian. The village thrived, forever under Ama’s eternal watch.',
                'Starlit Vows': 'The outpost crumbled, but Zara and Kofi escaped in a pod, Earth’s glow guiding them. They landed in a new colony, building a home. Their love became legend, whispered under new skies.',
                'The Silent Bell': 'Tunde faced the figure, its eyes hollow. He smashed the bell, silence falling. The mist cleared, but at night, Tunde heard faint chimes, a reminder the spirit lingered, watching.',
                'The Last Signal': 'Ada activated the crystal, voices flooding her mind. They were Martians, preserved in code. She uploaded them to her ship, granting life. Mars glowed faintly, and Ada smiled, her pod now home to a reborn race.',
                'The Iron Crown': 'Nia fought the crown’s whispers, seeking a sage. He broke its curse, freeing her. The village rose, no longer enslaved. Nia buried the crown, vowing to guard her heart, her eyes clear.',
                'Echoes of Lagos': 'Bola jumped time, catching the thief in 2069. She seized the device, stabilizing the timeline. Lagos thrived, her name legend. Bola retired her scanner, but kept the note.',
                'The Sky Weaver': 'Efia’s wings soared, leading her to a sky city. She trained others, her gift spreading. The raiders returned, but her fleet prevailed. Efia became the Sky Queen.',
                'Red Dust Duel': 'Jide outran the mechs, finding their source—a rogue AI. He hacked it, shutting them down. The dunes quieted.',
                'The Forgotten Mask': 'Aisha burned the mask, its secrets ash. The village forgave, but she felt its gaze. She danced again, free, her steps lighter. The carvings’ glow faded.',
                'The Quantum Griot': 'Kwame’s final tale rewrote invaders’ code, turning them to peace. Lagos shone, his voice eternal. He passed his tales, a new griot rising, the story unbroken.',
                'The River’s Wrath': 'Olu’s spear banished the spirit, his son safe. The river stilled, but its eyes lingered. He taught his son to respect it, their village now at peace.',
                'The Starborn Child': 'Zuri’s light united tribes, peace spreading. She trained others, her glow fading. She returned home, her legend a comet, guiding the plains.',
                'The Ghost Circuit': 'Wanjiku freed the ghosts, Nairobi’s lights her legacy. She mentored hackers, her code living on. The grid hummed, her unplugging a new myth.',
                'The Blood Forge': 'Chidi’s blade ended war, but its hunger turned. He quenched it with his life, village safe. His forge cooled, a monument to sacrifice.',
                'The Void Choir': 'Fatima’s crew escaped, but her song lingered. They sealed her ship, the void silent. Her voice echoed, a warning for future pilots.',
                'The Time Weaver': 'Adanna saved Kofi, vanishing in time. He searched timelines, finding her. They wove a new story, their love eternal, needle in hand.',
                'The Obsidian Blade': 'Yemi’s victory sparked her rule. She forged peace, blade sheathed. Her arena became a school, her name a star.',
                'The Pulse Thief': 'Tobi saved Kinshasa, its AI sparing him. He guarded its core, city lights his home. His theft became a tale of redemption.',
                'The Moonlit Pact': 'Ife and Taiwo broke the moon’s hold, their bond stronger. They led their people, the deity free, moonlight now a blessing.',
                'The Codebreaker’s Curse': 'Sana saved Abuja, curse lifted. She trained cryptics, her visions clear. The city thrived, her pen a beacon.',
                'The Ember Child': 'Aminat joined her volcano, her flames a guide. She lit deserts, wanderers safe. Her fire burned, a legend born.',
                'The Shadow Net': 'Lara freed Cape Town, her code legend. She vanished, teaching others. The net rose, her hack a whisper in freedom.',
                'The Bone Flute': 'Kofi buried the flute, spirits gone. He sang new songs, his village safe. The crack lingered, a warning.',
                'The Crystal Veil': 'Nneka freed herself, gem shattered. She led her tribe, wisdom her light. The village grew, her blindness a gift.'
            };

            return `Finished "${story.title}": ${endings[story.title]}`;
        }

        // Load News and Stories on Page Load
        window.addEventListener('load', () => {
            fetchNews();
            displayStories();
        });

        // AI Chatbot Functionality
        const chatHistory = [];
        let gameState = null;
        let userPreferences = { genres: [], mood: 'neutral' };
        const booksData = [
            { title: 'Pishon: The Uprising', description: 'Dayo, a young man with a stained history...', genre: 'Sci-Fi' },
            { title: 'The Flare', description: 'Alex Rosicky, resurrected by the Neon Stone...', genre: 'Sci-Fi' },
            { title: 'Orchids', description: 'A timeless tale of love that spans ages...', genre: 'Romance' },
            { title: 'Teen-Age R', description: 'Ordinary high school teens...', genre: 'Young Adult' },
            { title: 'Within The Dark', description: 'In a world ruled by a tyrannical...', genre: 'Fantasy' }
        ];
        const triviaQuestions = [
            { question: 'What is the name of the kingdom in Pishon: The Uprising?', answer: 'Pishon' },
            { question: 'Who is the main character in The Flare?', answer: 'Alex Rosicky' },
            { question: 'What genre is Steve Universe known for?', answer: 'Afrofuturism' }
        ];
        const truthOrDare = {
            truths: ['What\'s your favorite book genre?', 'Have you ever written a story?'],
            dares: ['Share a fun fact about yourself!', 'Describe an alien world in 3 words!']
        };

        function generatePoem() {
            const themes = ['stars', 'neon', 'ancestors', 'future'];
            const theme = themes[Math.floor(Math.random() * themes.length)];
            return `Beneath the ${theme}’s glow, a tale unfolds,\n` +
                   `Of Afrofuturist dreams in cities bold.\n` +
                   `From baobab roots to cosmic skies,\n` +
                   `Our stories weave where freedom lies.\n` +
                   `— Cosmic AI`;
        }

        function createCharacter() {
            const names = ['Zara', 'Kweku', 'Ama', 'Tunde', 'Efia'];
            const classes = ['Neon Hacker', 'Starborn Warrior', 'Quantum Griot', 'Sky Weaver', 'Pulse Mystic'];
            const origins = ['Lagos 2070', 'Accra’s Nexus', 'Kinshasa’s Core', 'Wellrose Outpost', 'Nairobi Grid'];
            const name = names[Math.floor(Math.random() * names.length)];
            const charClass = classes[Math.floor(Math.random() * classes.length)];
            const origin = origins[Math.floor(Math.random() * origins.length)];
            return `Meet ${name}, a ${charClass} from ${origin}. Once a wanderer, ${name} discovered a hidden power tied to their ancestors. Now, they seek a lost artifact to unite their people. Use this character in a role-play or D&D adventure!`;
        }

        function analyzeSentiment(message) {
            const lowerMsg = message.toLowerCase();
            if (lowerMsg.includes('excited') || lowerMsg.includes('awesome') || lowerMsg.includes('love')) {
                return 'excited';
            } else if (lowerMsg.includes('sad') || lowerMsg.includes('sorry') || lowerMsg.includes('bad')) {
                return 'sad';
            } else if (lowerMsg.includes('curious') || lowerMsg.includes('wonder') || lowerMsg.includes('what')) {
                return 'curious';
            }
            return 'neutral';
        }

        function recommendContent(genre) {
            const story = shortStories.find(s => s.genre.toLowerCase() === genre.toLowerCase());
            const book = booksData.find(b => b.genre.toLowerCase() === genre.toLowerCase());
            if (story && book) {
                return `Since you like ${genre}, try the story "${story.title}" (${story.description}) or the book "${book.title}" (${book.description}).`;
            } else if (story) {
                return `Since you like ${genre}, try the story "${story.title}" (${story.description}).`;
            } else if (book) {
                return `Since you like ${genre}, try the book "${book.title}" (${book.description}).`;
            }
            return `No ${genre} content found. Try genres like Sci-Fi, Fantasy, or Romance!`;
        }

        function startInteractiveStory() {
            gameState = {
                type: 'interactiveStory',
                stage: 'start',
                story: { title: 'The Cosmic Shard', setting: 'Pishon’s neon jungle', protagonist: 'You' }
            };
            return `You begin a story: *The Cosmic Shard*. In Pishon’s neon jungle, you find a glowing shard. A drone approaches, demanding it. Do you 'fight', 'hide', or 'negotiate'?`;
        }

        function handleInteractiveStory(userMessage) {
            const lowerMsg = userMessage.toLowerCase();
            if (gameState.stage === 'start') {
                if (lowerMsg === 'fight') {
                    gameState.stage = 'fight';
                    return `You battle the drone, your fists sparking. It retreats, but you hear more coming. Do you 'search for the shard’s origin' or 'escape'?`;
                } else if (lowerMsg === 'hide') {
                    gameState.stage = 'hide';
                    return `You slip into the shadows, clutching the shard. It pulses, revealing a map. Do you 'follow the map' or 'stay hidden'?`;
                } else if (lowerMsg === 'negotiate') {
                    gameState.stage = 'negotiate';
                    return `You reason with the drone, offering peace. It scans the shard and leaves. A voice whispers, “Find the Nexus.” Do you 'head to the Nexus' or 'ignore the voice'?`;
                }
            } else if (gameState.stage === 'fight') {
                if (lowerMsg.includes('search')) {
                    gameState.stage = 'end';
                    return `You find an ancient temple, the shard’s home. It powers a city, uniting Pishon. Story complete! Start another?`;
                } else if (lowerMsg.includes('escape')) {
                    gameState.stage = 'end';
                    return `You flee, but lose the shard. Pishon dims. Story ends. Try again?`;
                }
            } else if (gameState.stage === 'hide') {
                if (lowerMsg.includes('follow')) {
                    gameState.stage = 'end';
                    return `The map leads to a hidden tribe. They hail you as a savior, using the shard for peace. Story complete! Start another?`;
                } else if (lowerMsg.includes('stay')) {
                    gameState.stage = 'end';
                    return `You stay hidden, but the shard fades. Pishon forgets you. Story ends. Try again?`;
                }
            } else if (gameState.stage === 'negotiate') {
                if (lowerMsg.includes('nexus')) {
                    gameState.stage = 'end';
                    return `At the Nexus, the shard activates, linking Pishon’s people. You’re a legend! Story complete! Start another?`;
                } else if (lowerMsg.includes('ignore')) {
                    gameState.stage = 'end';
                    return `You ignore the voice. The shard dims, and drones return. Story ends. Try again?`;
                }
            }
            if (lowerMsg === 'end') {
                const title = gameState.story.title;
                gameState = null;
                return `Story *${title}* ended. Start a new story or try another game?`;
            }
            return `Choose an action or say 'end' to stop the story.`;
        }

        function toggleChat() {
            const chatContainer = document.getElementById('chat-container');
            chatContainer.classList.toggle('active');
            if (chatContainer.classList.contains('active') && chatHistory.length === 0) {
                displayGreeting();
            }
        }

        function displayGreeting() {
            addMessage('Hey there! I\'m Steve\'s Cosmic AI, now with multidimensional flair! Explore Afrofuturistic tales, play games (trivia, D&D, role-play), or try new tricks: "write a poem", "create character", "start a story". You can also say "download stories" or "finish [story title]"!', 'bot');
        }

        function addMessage(text, sender) {
            const chatBody = document.getElementById('chat-body');
            const message = document.createElement('div');
            message.className = `chat-message ${sender}`;
            message.textContent = text;
            chatBody.appendChild(message);
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function addNewsItem(title, content) {
            const newsGrid = document.getElementById('news-grid');
            const newsItem = document.createElement('div');
            newsItem.className = 'section-bg p-6 rounded-lg';
            newsItem.innerHTML = `
                <h3 class="text-xl font-semibold">${title}</h3>
                <p class="mt-2 text-gray-300">${content}</p>
                <a href="#" class="text-blue-400 hover:underline mt-4 inline-block">Read More</a>
            `;
            newsGrid.prepend(newsItem);
        }

        function getBooksData(query) {
            return booksData.filter(book => book.title.toLowerCase().includes(query.toLowerCase()));
        }

        function startTrivia() {
            gameState = { type: 'trivia', questionIndex: 0, score: 0 };
            const question = triviaQuestions[gameState.questionIndex];
            return `Let's play trivia! Question 1: ${question.question} (Type your answer or say 'next' to move on.)`;
        }

        function handleQuestionAnswer(userMessage) {
            const question = triviaQuestions[gameState.questionIndex];
            if (userMessage.toLowerCase() === 'next') {
                gameState.questionIndex++;
            } else if (userMessage.toLowerCase().trim() === question.answer.toLowerCase()) {
                gameState.score++;
                gameState.questionIndex++;
                return `Correct! Score: ${gameState.score}.`;
            } else {
                gameState.questionIndex++;
                return `Nope, it was ${question.answer}.`;
            }
            if (gameState.questionIndex < triviaQuestions.length) {
                return `Next: ${triviaQuestions[gameState.questionIndex].question}`;
            } else {
                const finalMessage = `Game over! Score: ${gameState.score}/${triviaQuestions.length}. Play again or try another game?`;
                gameState = null;
                return finalMessage;
            }
        }

        function startTruthOrDare() {
            gameState = { type: 'choice' };
            return 'Truth or Dare? Type "truth" or "dare" to choose!';
        }

        function handleTruthOrDare(choice) {
            if (choice.toLowerCase() === 'truth') {
                const truth = truthOrDare.truths[Math.floor(Math.random() * truthOrDare.truths.length)];
                return `Truth: ${truth} (Answer or say 'next' for another!)`;
            } else if (choice.toLowerCase() === 'dare') {
                const dare = truthOrDare.dares[Math.floor(Math.random() * truthOrDare.dares.length)];
                return `Dare: ${dare} (Do it or say 'next' for another!)`;
            } else if (choice.toLowerCase() === 'next') {
                return 'Truth or Dare? Type "truth" or "dare"!';
            }
            return `Please type 'truth', 'dare', or 'next'.`;
        }

        function startDungeonsAndDragons() {
            gameState = { 
                type: 'dnd', 
                player: { name: '', class: '' }, 
                scene: 'start', 
                inventory: [] 
            };
            return 'Welcome to a mini D&D adventure in Pishon\'s Afrofuturistic world! What\'s your character\'s name and class (e.g., warrior, mystic)?';
        }

        function handleDungeonsAndDragons(userMessage) {
            if (gameState.scene === 'start') {
                const [name, ...classParts] = userMessage.split(' ');
                gameState.player.name = name || 'Adventurer';
                gameState.player.class = classParts.join(' ') || 'Explorer';
                gameState.scene = 'village';
                return `Welcome, ${gameState.player.name} the ${gameState.player.class}! You arrive in a bustling Pishon village. A shadowy figure offers a quest to find a lost artifact. Do you 'accept', 'ask for details', or 'decline'?`;
            } else if (gameState.scene === 'village') {
                if (userMessage.toLowerCase() === 'accept') {
                    gameState.scene = 'forest';
                    gameState.inventory.push('map');
                    return `You accept and head into the forest with a map. You hear a rustle. Do you 'investigate', 'hide', or 'continue'?`;
                } else if (userMessage.toLowerCase() === 'ask for details') {
                    return `The figure says the artifact is a crystal that powers Pishon. It's in a forest. Do you 'accept' or 'decline'?`;
                } else if (userMessage.toLowerCase() === 'decline') {
                    gameState = null;
                    return `You decline and return to the village. Want a new adventure or another game?`;
                }
            } else if (gameState.scene === 'forest') {
                if (userMessage.toLowerCase() === 'investigate') {
                    gameState.inventory.push('crystal');
                    gameState.scene = 'end';
                    return `You find a glowing crystal guarded by a drone. Using your ${gameState.player.class} skills, you retrieve it. Quest complete! Inventory: ${gameState.inventory.join(', ')}. Play again?`;
                } else if (userMessage.toLowerCase() === 'hide') {
                    return `You hide, but find nothing. Return to 'village' or 'end' quest?`;
                } else if (userMessage.toLowerCase() === 'continue') {
                    gameState.scene = 'end';
                    return `You miss the crystal and return empty-handed. Play again or try another game?`;
                }
            } else if (gameState.scene === 'end') {
                gameState = null;
                return `Adventure over! Start a new D&D quest or another game?`;
            }
            return `Invalid action. Try again or say 'end' to quit.`;
        }

        function startRolePlay() {
            gameState = { type: 'roleplay', character: '' };
            return `Let's role-play in Steve's Afrofuturistic universe! Who do you want to be? (e.g., Dayo, a neon fighter)`;
        }

        function handleRolePlay(userMessage) {
            if (!gameState.character) {
                gameState.character = userMessage.trim() || 'Unknown Hero';
                return `You're ${gameState.character} in Wellrose, facing a rogue superhuman. What do you do? (e.g., fight, negotiate, flee)`;
            } else if (userMessage.toLowerCase() === 'end') {
                const character = gameState.character;
                gameState = null;
                return `Role-play ended, ${character}! New role-play or another game?`;
            } else {
                return `As ${gameState.character}, you ${userMessage}. The rogue superhuman blasts energy. What's your next move? (or say 'end')`;
            }
        }

        function generateResponse(userMessage) {
            chatHistory.push(userMessage);
            const lowerMessage = userMessage.toLowerCase();
            userPreferences.mood = analyzeSentiment(userMessage);

            // Update genre preferences
            ['sci-fi', 'fantasy', 'romance', 'horror', 'mystery', 'adventure', 'young adult'].forEach(genre => {
                if (lowerMessage.includes(genre) && !userPreferences.genres.includes(genre)) {
                    userPreferences.genres.push(genre);
                }
            });

            if (gameState) {
                if (gameState.type === 'trivia') return handleQuestionAnswer(userMessage);
                if (gameState.type === 'choice') return handleTruthOrDare(userMessage);
                if (gameState.type === 'dnd') return handleDungeonsAndDragons(userMessage);
                if (gameState.type === 'roleplay') return handleRolePlay(userMessage);
                if (gameState.type === 'interactiveStory') return handleInteractiveStory(userMessage);
            }

            if (['hi', 'hello', 'hey'].includes(lowerMessage)) {
                return `Yo! I'm Steve's Cosmic AI, upgraded for multidimensional adventures. Try "write a poem", "create character", "start a story", or classic games like "trivia", "dnd". You can also "download stories" or "finish [story title]". What's up?`;
            } else if (['bye', 'goodbye'].includes(lowerMessage)) {
                return "Catch you later! Return for more cosmic tales or games.";
            }

            if (lowerMessage.includes('poem')) {
                return generatePoem();
            }
            if (lowerMessage.includes('create character') || lowerMessage.includes('new character')) {
                return createCharacter();
            }
            if (lowerMessage.includes('start a story') || lowerMessage.includes('interactive story')) {
                return startInteractiveStory();
            }
            if (lowerMessage.includes('recommend') || lowerMessage.includes('suggest')) {
                const genre = userPreferences.genres[0] || 'Sci-Fi';
                return recommendContent(genre);
            }

            if (lowerMessage.includes('trivia')) {
                return startTrivia();
            }
            if (lowerMessage.includes('truth or dare')) {
                return startTruthOrDare();
            }
            if (lowerMessage.includes('dungeons') || lowerMessage.includes('dnd')) {
                return startDungeonsAndDragons();
            }
            if (lowerMessage.includes('roleplay') || lowerMessage.includes('role-play')) {
                return startRolePlay();
            }

            if (lowerMessage.includes('download stories')) {
                return downloadStories();
            }

            if (lowerMessage.includes('finish')) {
                const titleMatch = userMessage.match(/finish\s+(.+)/i);
                if (titleMatch && titleMatch[1]) {
                    return finishStory(titleMatch[1].trim());
                }
                return "Which story to finish? Try 'finish The Neon Oracle' or another title from Stories.";
            }

            if (lowerMessage.includes('afrofuturism')) {
                addNewsItem('Afrofuturism Spotlight', 'Afrofuturistic narratives are reshaping global sci-fi!');
                return "Afrofuturism blends African culture with sci-fi. Want more on its impact or Steve's books?";
            } else if (lowerMessage.includes('book') || lowerMessage.includes('books')) {
                const books = getBooksData(lowerMessage);
                if (books.length > 0) {
                    const bookTitles = books.map(b => b.title).join(', ');
                    addNewsItem('Book Buzz', `Fans love ${bookTitles}!`);
                    return `Found books: ${bookTitles}. Want a summary or news?`;
                }
                return "Check out Pishon: The Uprising, The Flare, Orchids, Teen-Age R, or Within The Dark. Curious about one?";
            } else if (lowerMessage.includes('news')) {
                fetchNews();
                return "Latest news loaded! Check the News section or ask for specifics.";
            } else if (lowerMessage.includes('stories') || lowerMessage.includes('quote')) {
                displayStories();
                return "Fresh stories and quotes loaded! See the Stories section or try 'download stories'.";
            } else if (lowerMessage.includes('contact') || lowerMessage.includes('reach out')) {
                return "Reach Steve via the Contact section or X, email. Need the form?";
            }

            // Mood-based response
            if (userPreferences.mood === 'excited') {
                return "You're buzzing with energy! Wanna dive into a thrilling story or game? Try 'start a story' or 'trivia'!";
            } else if (userPreferences.mood === 'sad') {
                return "Feeling down? How about a hopeful tale or a fun game to lift your spirits? Try 'write a poem' or 'recommend Romance'.";
            } else if (userPreferences.mood === 'curious') {
                return "Got questions? I can craft a poem, recommend a sci-fi story, or start a D&D quest. What's sparking your interest?";
            }

            return "Not sure what you mean, but I'm ready to explore! Try 'write a poem', 'start a story', 'trivia', or ask about books/news.";
        }

        function sendMessage() {
            const chatInput = document.getElementById('chat-input');
            const userMessage = chatInput.value.trim();
            if (!userMessage) return;
            addMessage(userMessage, 'user');
            const response = generateResponse(userMessage);
            addMessage(response, 'bot');
            chatInput.value = '';
        }

        document.getElementById('chatbot-handle').addEventListener('click', toggleChat);
        document.getElementById('chat-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>
</html>